<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd"
              name="service_estimate"
              pageWidth="595" pageHeight="842" columnWidth="515"
              leftMargin="40" rightMargin="40" topMargin="40" bottomMargin="40"
              uuid="a1b2c3d4-e5f6-4789-9abc-def012345678">

    <!-- Parameters provided by backend -->
    <parameter name="APPLICATION_NO" class="java.lang.String"/>
    <parameter name="DEPT_ID" class="java.lang.String"/>
    <parameter name="TOTAL_LENGTH" class="java.lang.String"/>
    <parameter name="WIRING_TYPE" class="java.lang.String"/>
    <parameter name="LOOP_CABLE" class="java.lang.String"/>
    <parameter name="INSIDE_LENGTH" class="java.lang.String"/>
    <parameter name="DISTANCE_TO_SP" class="java.lang.String"/>
    <parameter name="SIN" class="java.lang.String"/>
    <parameter name="BUSINESS_TYPE" class="java.lang.String"/>
    <parameter name="NO_OF_SPANS" class="java.lang.String"/>
    <parameter name="POLE_NO" class="java.lang.String"/>
    <parameter name="DISTANCE_FROM_SS" class="java.lang.String"/>
    <parameter name="SUBSTATION" class="java.lang.String"/>
    <parameter name="TRANSFORMER_CAPACITY" class="java.lang.String"/>
    <parameter name="TRANSFORMER_LOAD" class="java.lang.String"/>
    <parameter name="TRANSFORMER_PEAK_LOAD" class="java.lang.String"/>
    <parameter name="FEEDER_CONTROL_TYPE" class="java.lang.String"/>
    <parameter name="PHASE" class="java.lang.String"/>
    <parameter name="PRINTED_AT" class="java.util.Date"/>

    <title>
        <band height="60">
            <staticText>
                <reportElement x="0" y="0" width="515" height="24"/>
                <textElement textAlignment="Center">
                    <font size="16" isBold="true"/>
                </textElement>
                <text><![CDATA[Service Estimate]]></text>
            </staticText>
            <textField>
                <reportElement x="0" y="28" width="515" height="18"/>
                <textElement textAlignment="Center">
                    <font size="10"/>
                </textElement>
                <textFieldExpression><![CDATA["Printed: " + new java.text.SimpleDateFormat("yyyy-MM-dd HH:mm").format($P{PRINTED_AT})]]></textFieldExpression>
            </textField>
        </band>
    </title>

    <detail>
        <band height="680">
            <!-- Header block -->
            <frame>
                <reportElement x="0" y="0" width="515" height="90"/>
                <staticText>
                    <reportElement x="0" y="0" width="150" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[Application No:]]></text>
                </staticText>
                <textField>
                    <reportElement x="160" y="0" width="355" height="16"/>
                    <textFieldExpression><![CDATA[$P{APPLICATION_NO}]]></textFieldExpression>
                </textField>

                <staticText>
                    <reportElement x="0" y="20" width="150" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[Department:]]></text>
                </staticText>
                <textField>
                    <reportElement x="160" y="20" width="355" height="16"/>
                    <textFieldExpression><![CDATA[$P{DEPT_ID}]]></textFieldExpression>
                </textField>
            </frame>

            <!-- Summary table -->
            <frame>
                <reportElement x="0" y="110" width="515" height="280"/>
                <!-- Each row: label + value -->

                
                <staticText>
                    <reportElement x="0" y="0" width="200" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[Total Line Length]]></text>
                </staticText>
                <textField>
                    <reportElement x="210" y="0" width="305" height="16"/>
                    <textFieldExpression><![CDATA[$P{TOTAL_LENGTH}]]></textFieldExpression>
                </textField>

                <staticText>
                    <reportElement x="0" y="20" width="200" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[Wiring Type]]></text>
                </staticText>
                <textField>
                    <reportElement x="210" y="20" width="305" height="16"/>
                    <textFieldExpression><![CDATA[$P{WIRING_TYPE}]]></textFieldExpression>
                </textField>

                <staticText>
                    <reportElement x="0" y="40" width="200" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[Loop Cable]]></text>
                </staticText>
                <textField>
                    <reportElement x="210" y="40" width="305" height="16"/>
                    <textFieldExpression><![CDATA[$P{LOOP_CABLE}]]></textFieldExpression>
                </textField>

                <staticText>
                    <reportElement x="0" y="60" width="200" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[Inside Length]]></text>
                </staticText>
                <textField>
                    <reportElement x="210" y="60" width="305" height="16"/>
                    <textFieldExpression><![CDATA[$P{INSIDE_LENGTH}]]></textFieldExpression>
                </textField>

                <staticText>
                    <reportElement x="0" y="80" width="200" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[Distance to Service Point]]></text>
                </staticText>
                <textField>
                    <reportElement x="210" y="80" width="305" height="16"/>
                    <textFieldExpression><![CDATA[$P{DISTANCE_TO_SP}]]></textFieldExpression>
                </textField>

                <staticText>
                    <reportElement x="0" y="100" width="200" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[SIN]]></text>
                </staticText>
                <textField>
                    <reportElement x="210" y="100" width="305" height="16"/>
                    <textFieldExpression><![CDATA[$P{SIN}]]></textFieldExpression>
                </textField>

                <staticText>
                    <reportElement x="0" y="120" width="200" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[Business Type]]></text>
                </staticText>
                <textField>
                    <reportElement x="210" y="120" width="305" height="16"/>
                    <textFieldExpression><![CDATA[$P{BUSINESS_TYPE}]]></textFieldExpression>
                </textField>

                <staticText>
                    <reportElement x="0" y="140" width="200" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[No. of Spans]]></text>
                </staticText>
                <textField>
                    <reportElement x="210" y="140" width="305" height="16"/>
                    <textFieldExpression><![CDATA[$P{NO_OF_SPANS}]]></textFieldExpression>
                </textField>

                <staticText>
                    <reportElement x="0" y="160" width="200" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[Pole No]]></text>
                </staticText>
                <textField>
                    <reportElement x="210" y="160" width="305" height="16"/>
                    <textFieldExpression><![CDATA[$P{POLE_NO}]]></textFieldExpression>
                </textField>

                <staticText>
                    <reportElement x="0" y="180" width="200" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[Distance From SS]]></text>
                </staticText>
                <textField>
                    <reportElement x="210" y="180" width="305" height="16"/>
                    <textFieldExpression><![CDATA[$P{DISTANCE_FROM_SS}]]></textFieldExpression>
                </textField>

                <staticText>
                    <reportElement x="0" y="200" width="200" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[Substation]]></text>
                </staticText>
                <textField>
                    <reportElement x="210" y="200" width="305" height="16"/>
                    <textFieldExpression><![CDATA[$P{SUBSTATION}]]></textFieldExpression>
                </textField>

                <staticText>
                    <reportElement x="0" y="220" width="200" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[Transformer Capacity]]></text>
                </staticText>
                <textField>
                    <reportElement x="210" y="220" width="305" height="16"/>
                    <textFieldExpression><![CDATA[$P{TRANSFORMER_CAPACITY}]]></textFieldExpression>
                </textField>

                <staticText>
                    <reportElement x="0" y="240" width="200" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[Transformer Load]]></text>
                </staticText>
                <textField>
                    <reportElement x="210" y="240" width="305" height="16"/>
                    <textFieldExpression><![CDATA[$P{TRANSFORMER_LOAD}]]></textFieldExpression>
                </textField>

                <staticText>
                    <reportElement x="0" y="260" width="200" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[Transformer Peak Load]]></text>
                </staticText>
                <textField>
                    <reportElement x="210" y="260" width="305" height="16"/>
                    <textFieldExpression><![CDATA[$P{TRANSFORMER_PEAK_LOAD}]]></textFieldExpression>
                </textField>

                <staticText>
                    <reportElement x="0" y="280" width="200" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[Feeder Control Type]]></text>
                </staticText>
                <textField>
                    <reportElement x="210" y="280" width="305" height="16"/>
                    <textFieldExpression><![CDATA[$P{FEEDER_CONTROL_TYPE}]]></textFieldExpression>
                </textField>

                <staticText>
                    <reportElement x="0" y="300" width="200" height="16"/>
                    <textElement><font isBold="true"/></textElement>
                    <text><![CDATA[Phase]]></text>
                </staticText>
                <textField>
                    <reportElement x="210" y="300" width="305" height="16"/>
                    <textFieldExpression><![CDATA[$P{PHASE}]]></textFieldExpression>
                </textField>
            </frame>

            <!-- Footer note -->
            <staticText>
                <reportElement x="0" y="410" width="515" height="16"/>
                <textElement textAlignment="Center">
                    <font size="9"/>
                </textElement>
                <text><![CDATA[This is a system generated Service Estimate.]]></text>
            </staticText>
        </band>
    </detail>

</jasperReport>
